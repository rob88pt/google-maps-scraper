# Tasks

## Phase 3: Archive System
- [x] Investigate current delete implementation in `src/app/api/leads/route.ts` and `src/components/leads/delete-leads-button.tsx`
- [x] Create Implementation Plan for Archive System
- [x] Update API to support archiving leads (Status update instead of deletion)
- [x] Update Leads Table UI to replace Delete action with Archive
  - [x] Implement `ArchiveLeadsButton` component
  - [x] Update `LeadsTable` row actions
- [x] Implement "Show Archived" toggle in Toolbar
- [x] Update Lead Detail Panel to support Archive/Unarchive actions
- [x] Verify functionality via browser and manual tests
- [x] Debug Archive System Failures
  - [x] Identify FK constraint mismatch in `lead_status` and `lead_notes`
  - [x] Apply migration to fix schema
  - [x] Verify fix with ZenDharma lead
  - [x] Fix 405 Method Not Allowed error by creating `/api/leads/unarchive` route
  - [x] Add feedback toasts to all archive/unarchive actions
  - [x] Improve `GET` filtering logic to handle multi-user joins correctly
