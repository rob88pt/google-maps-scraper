# Investigation Prompt: Leads Page Hydration Mismatch & Checkbox Interactivity

## The Context
We have recently implemented a **Bulk Delete** feature for the Leads command center. This includes:
1.  **Backend**: `DELETE /api/leads` for multi-ID removal.
2.  **State**: A `useDeleteLeads` hook and refined row selection in `LeadsTable`.
3.  **UI**: A `DeleteLeadsButton` in the toolbar that activates when leads are selected.

## The Problem
Despite the logic being in place, **individual row checkboxes in the leads table are non-responsive** in the browser. They do not toggle their checked state, and as a result, the delete button cannot be activated.

### Technical Discovery
- **Hydration Mismatch**: The root cause is a persistent React hydration mismatch on the `/leads` page.
- **Symptoms**: Client-side event handlers (like `onCheckedChange` on the checkboxes) are failing to attach because the initial DOM generated by the server differs from the client's first render.
- **Nuance**: Interestingly, the **"Select All" checkbox in the table header works correctly**, while the row-level checkboxes do not. This suggests the mismatch might be deeper in the table body or related to how rows are rendered.

## High-Priority Investigation Areas
1.  **Media Queries**: We use a `useMediaQuery` hook and `isDesktop` boolean to conditionally hide columns (e.g., `input_id`, `indicators`). If this is evaluated during SSR, it will likely mismatch with the client.
2.  **Local Storage**: The `useLocalStorage` hook handles table persistence. Ensure it defaults to a stable server-safe state during the initial render.
3.  **Nested Interactivity**: Check for invalid HTML (e.g., `<button>` or `<a>` inside another interactive element) within the `TableRow` or `TableCell` that might be causing React to bail on hydration.
4.  **Row Identification**: We use `getRowId: (row) => row.id.toString()`. Verify that there are no duplicate IDs in the data being returned by the API.

## Goal
Resolve the hydration mismatch so that checkboxes become interactive, allowing us to finalise and verify the Bulk Delete functionality.

## Reference Files
- `src/components/leads/leads-table.tsx`
- `src/app/leads/page.tsx`
- `src/lib/hooks/use-media-query.ts`
- `src/lib/hooks/use-local-storage.ts`
