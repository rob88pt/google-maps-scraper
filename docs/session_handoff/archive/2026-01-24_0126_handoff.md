# Session Handoff: Configurable Reviews & Bug Fixes

Read this file to pick up where we left off. We are about to implement a configurable review count by modifying the Go scraper fork and updating the webapp.

## Project Locations
- **WebApp**: `d:\Websites\GMaps_scraper_gosom\leads-command-center`
- **Scraper Source**: `d:\Websites\GMaps_scraper_gosom\source`

## Context Files to Read First
1. [implementation_plan.md](file:///C:/Users/Legion/.gemini/antigravity/brain/1ea2daf4-c924-4d7a-bd8f-a98a3a3d0106/implementation_plan.md) - **CRITICAL**: The detailed vertical-stack plan.
2. `docs/active_context.md` - Current focus overview.
3. `docs/fork_strategy.md` - Scraper fork maintenance guide.

## What Was Done This Session
- **Research**: Investigated the `google-maps-scraper` Go source. Found that the "~300 reviews" limit is driven by a hardcoded `maxScrollAttempts := 30` in `source/gmaps/reviews.go`.
- **Planning**: Developed a plan to change the `-extra-reviews` flag from a `bool` to an `int`. This avoids new flag names and uses existing terminology.
- **Cleanup**: Reverted a trial implementation of `maxReviews` to start fresh with the cleaner `extra-reviews` integer approach.
- **Documentation**: Updated `active_context.md` and `implementation_plan.md`.

## What's Left to Do (Per implementation_plan.md)
1. **Scraper Fork**:
   - Change `ExtraReviews` type in `runner.go`, `job.go`, and `place.go`.
   - Update `reviews.go` to use the passed integer for scroll attempts.
   - Rebuild image: `docker build -t google-maps-scraper:custom .`
2. **WebApp**:
   - Update `schemas.ts` and `docker.ts` to handle `extraReviews` as a number.
   - Update `job-form.tsx` UI to allow entering the count.
3. **Bug Fixes**:
   - Fix preset saving (missing `user_id` in API).
   - Fix leads filtering (field names and query syntax).
   - Fix thumbnail display issues.

## Verification Checklist
- [ ] Run scraper with `-extra-reviews 50` and verify it collects more reviews (~500).
- [ ] Save/Load presets in the webapp.
- [ ] Filter leads by city/email.

## Suggested First Action
Start with the Go source modifications in `d:\Websites\GMaps_scraper_gosom\source\runner\runner.go` to change `ExtraReviews` to an `int`.
