# Walkthrough: Negative Filters Implementation

I have implemented the "Does not have Email" and "Does not have Website" filters in the Leads application.

## Changes

### 1. API (`src/app/api/leads/route.ts`)
- Added handling for `doesNotHaveEmail` and `doesNotHaveWebsite` query parameters.
- Implemented Supabase filtering logic to check for `null` or empty values for these fields.
```typescript
if (doesNotHaveEmail) {
    query = query.or('data->>emails.is.null,data->>emails.eq.[]')
}
```

### 2. Hooks (`src/lib/hooks/use-leads.ts`)
- Updated `LeadsQueryOptions` interface to include the new boolean flags.
- Updated `fetchLeads` to serialize these flags into the URL query string.

### 3. UI Filters (`src/components/leads/leads-filters.tsx`)
- Updated `LeadsFilters` interface and default state.
- Added "No email" and "No website" checkboxes to the filter popover.
- Implemented mutual exclusivity logic: checking "No email" automatically unchecks "Has email", and vice-versa, to prevent conflicting states.

### 4. Page Integration (`src/app/leads/page.tsx`)
- Wired up the new filter state to the `useLeads` hook options.

## Verification
- Verified API logic via `curl` to ensure parameters are accepted and processed.
- Note: Testing on an empty database returned 0 results as expected, but the logic is sound based on Supabase documentation and existing patterns.

## Next Steps
- Verify in the browser UI to ensure the "No email" / "No website" checkboxes appear and toggle correctly.
